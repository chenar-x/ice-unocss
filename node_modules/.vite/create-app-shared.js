import {
  createBrowserHistory,
  createHashHistory,
  createMemoryHistory
} from "./chunk-ABIN5JJR.js";
import {
  require_query_string
} from "./chunk-NPOD67AZ.js";
import "./chunk-JG3BSTLK.js";
import {
  __commonJS,
  __esm,
  __export,
  __reExport,
  __toModule
} from "./chunk-YYC2CZC2.js";

// node_modules/@uni/env/es/index.js
var es_exports = {};
__export(es_exports, {
  default: () => es_default,
  isBaiduSmartProgram: () => isBaiduSmartProgram,
  isByteDanceMicroApp: () => isByteDanceMicroApp,
  isKraken: () => isKraken,
  isKuaiShouMiniProgram: () => isKuaiShouMiniProgram,
  isMiniApp: () => isMiniApp,
  isNode: () => isNode,
  isQuickApp: () => isQuickApp,
  isWeChatMiniProgram: () => isWeChatMiniProgram,
  isWeb: () => isWeb,
  isWeex: () => isWeex
});
var isWeb, isNode, isWeex, isKraken, isMiniApp, isByteDanceMicroApp, isBaiduSmartProgram, isKuaiShouMiniProgram, isWeChatMiniProgram, isQuickApp, es_default;
var init_es = __esm({
  "node_modules/@uni/env/es/index.js"() {
    isWeb = typeof window !== "undefined" && "onload" in window;
    isNode = typeof process !== "undefined" && !!(process.versions && process.versions.node);
    isWeex = typeof WXEnvironment !== "undefined" && WXEnvironment.platform !== "Web";
    isKraken = typeof __kraken__ !== "undefined";
    isMiniApp = typeof my !== "undefined" && my !== null && typeof my.alert !== "undefined";
    isByteDanceMicroApp = typeof tt !== "undefined" && tt !== null && typeof tt.showToast !== "undefined";
    isBaiduSmartProgram = typeof swan !== "undefined" && swan !== null && typeof swan.showToast !== "undefined";
    isKuaiShouMiniProgram = typeof ks !== "undefined" && ks !== null && typeof ks.showToast !== "undefined";
    isWeChatMiniProgram = !isByteDanceMicroApp && typeof wx !== "undefined" && wx !== null && (typeof wx.request !== "undefined" || typeof wx.miniProgram !== "undefined");
    isQuickApp = typeof global !== "undefined" && global !== null && typeof global.callNative !== "undefined" && !isWeex;
    es_default = {
      isWeb,
      isNode,
      isWeex,
      isKraken,
      isMiniApp,
      isByteDanceMicroApp,
      isBaiduSmartProgram,
      isKuaiShouMiniProgram,
      isWeChatMiniProgram,
      isQuickApp
    };
  }
});

// node_modules/universal-env/lib/index.js
var require_lib = __commonJS({
  "node_modules/universal-env/lib/index.js"(exports) {
    "use strict";
    exports.__esModule = true;
    var _env = (init_es(), es_exports);
    Object.keys(_env).forEach(function(key) {
      if (key === "default" || key === "__esModule")
        return;
      if (key in exports && exports[key] === _env[key])
        return;
      exports[key] = _env[key];
    });
  }
});

// node_modules/miniapp-history/es/listeners.js
var require_listeners = __commonJS({
  "node_modules/miniapp-history/es/listeners.js"(exports) {
    "use strict";
    exports.__esModule = true;
    exports.addListener = addListener;
    exports.fireListeners = fireListeners;
    var listeners = {};
    function addListener(pageId, callback) {
      if (!listeners[pageId])
        listeners[pageId] = [];
      listeners[pageId].push(callback);
      return listeners[pageId];
    }
    function fireListeners(location, action) {
      var pageId = location._pageId;
      if (listeners[pageId]) {
        for (var index in listeners[pageId]) {
          listeners[pageId][index]({
            location,
            action
          });
        }
      }
    }
  }
});

// node_modules/miniapp-history/es/constants.js
var require_constants = __commonJS({
  "node_modules/miniapp-history/es/constants.js"(exports) {
    "use strict";
    exports.__esModule = true;
    exports.REPLACE = exports.POP = exports.PUSH = void 0;
    var PUSH = "PUSH";
    exports.PUSH = PUSH;
    var POP = "POP";
    exports.POP = POP;
    var REPLACE = "REPLACE";
    exports.REPLACE = REPLACE;
  }
});

// node_modules/miniapp-history/es/router.js
var require_router = __commonJS({
  "node_modules/miniapp-history/es/router.js"(exports) {
    "use strict";
    exports.__esModule = true;
    exports.__updateRouterMap = __updateRouterMap;
    exports.default = generateActions;
    var _universalEnv = require_lib();
    var _listeners = require_listeners();
    var _constants = require_constants();
    var __routerMap = {};
    var apiCore;
    if (_universalEnv.isMiniApp) {
      apiCore = my;
    } else if (_universalEnv.isWeChatMiniProgram) {
      apiCore = wx;
    } else if (_universalEnv.isByteDanceMicroApp) {
      apiCore = tt;
    } else if (_universalEnv.isBaiduSmartProgram) {
      apiCore = swan;
    } else if (_universalEnv.isKuaiShouMiniProgram) {
      apiCore = ks;
    }
    function redirectTo(location, options) {
      options.success = function() {
        (0, _listeners.fireListeners)(location, _constants.REPLACE);
      };
      apiCore.redirectTo(options);
    }
    function navigateTo(location, options) {
      options.success = function() {
        (0, _listeners.fireListeners)(location, _constants.PUSH);
      };
      apiCore.navigateTo(options);
    }
    function navigateBack(location, options) {
      apiCore.navigateBack(options);
      (0, _listeners.fireListeners)(location, _constants.POP);
    }
    function push(location, path, query) {
      return navigateTo(location, {
        url: generateUrl(path, query)
      });
    }
    function replace(location, path, query) {
      return redirectTo(location, {
        url: generateUrl(path, query)
      });
    }
    function go() {
      throw new Error("Unsupported go in miniapp.");
    }
    function back(location, n) {
      if (n === void 0) {
        n = 1;
      }
      return navigateBack(location, {
        delta: n
      });
    }
    function goBack(location, n) {
      if (n === void 0) {
        n = 1;
      }
      return navigateBack(location, {
        delta: n
      });
    }
    function goForward() {
      throw new Error("Unsupported goForward in miniapp.");
    }
    function canGo() {
      return true;
    }
    function generateUrl(path, query) {
      var _path$split = path.split("?"), pathname = _path$split[0], search = _path$split[1];
      var miniappPath = __routerMap[pathname];
      if (!miniappPath) {
        throw new Error("Path " + path + " is not found");
      }
      if (query) {
        if (search) {
          search += "&" + stringifyQuery(query);
        } else {
          search = stringifyQuery(query);
        }
      }
      return search ? "/" + miniappPath + "?" + search : "/" + miniappPath;
    }
    function stringifyQuery(query) {
      return Object.keys(query).reduce(function(total, nextKey, index) {
        return "" + total + (index ? "&" : "") + nextKey + "=" + query[nextKey];
      }, "");
    }
    function __updateRouterMap(routes) {
      routes.map(function(route) {
        __routerMap[route.path] = route.source;
      });
    }
    function generateActions(location) {
      var actions = {
        push,
        replace,
        back,
        go,
        canGo,
        goForward,
        goBack
      };
      return Object.keys(actions).reduce(function(result, actionName) {
        result[actionName] = actions[actionName].bind(null, location);
        return result;
      }, {});
    }
  }
});

// node_modules/miniapp-history/es/Location.js
var require_Location = __commonJS({
  "node_modules/miniapp-history/es/Location.js"(exports) {
    "use strict";
    exports.__esModule = true;
    exports.default = void 0;
    function _defineProperties(target, props) {
      for (var i = 0; i < props.length; i++) {
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor)
          descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
      }
    }
    function _createClass(Constructor, protoProps, staticProps) {
      if (protoProps)
        _defineProperties(Constructor.prototype, protoProps);
      if (staticProps)
        _defineProperties(Constructor, staticProps);
      return Constructor;
    }
    var Location = function() {
      function Location2() {
        this._currentPageOptions = {};
        this.hash = "";
      }
      var _proto = Location2.prototype;
      _proto.__updatePageOption = function __updatePageOption(pageOptions) {
        this._currentPageOptions = pageOptions;
      };
      _proto.__updatePageId = function __updatePageId(pageId) {
        this._pageId = pageId;
      };
      _createClass(Location2, [{
        key: "href",
        get: function get() {
          return this.pathname + this.search;
        }
      }, {
        key: "search",
        get: function get() {
          var _this = this;
          var search = "";
          Object.keys(this._currentPageOptions).forEach(function(key, index) {
            var query = key + "=" + _this._currentPageOptions[key];
            search += index === 0 ? "?" : "&";
            search += query;
          });
          return search;
        }
      }, {
        key: "pathname",
        get: function get() {
          var pages = getCurrentPages();
          if (pages.length === 0)
            return "";
          var currentPage = pages[pages.length - 1];
          return addLeadingSlash(currentPage.route);
        }
      }]);
      return Location2;
    }();
    exports.default = Location;
    function addLeadingSlash(str) {
      return str[0] === "/" ? str : "/" + str;
    }
  }
});

// node_modules/miniapp-history/es/History.js
var require_History = __commonJS({
  "node_modules/miniapp-history/es/History.js"(exports) {
    "use strict";
    exports.__esModule = true;
    exports.default = void 0;
    var _router = _interopRequireWildcard(require_router());
    var _Location = _interopRequireDefault(require_Location());
    var _listeners = require_listeners();
    function _interopRequireDefault(obj) {
      return obj && obj.__esModule ? obj : { default: obj };
    }
    function _getRequireWildcardCache(nodeInterop) {
      if (typeof WeakMap !== "function")
        return null;
      var cacheBabelInterop = new WeakMap();
      var cacheNodeInterop = new WeakMap();
      return (_getRequireWildcardCache = function _getRequireWildcardCache2(nodeInterop2) {
        return nodeInterop2 ? cacheNodeInterop : cacheBabelInterop;
      })(nodeInterop);
    }
    function _interopRequireWildcard(obj, nodeInterop) {
      if (!nodeInterop && obj && obj.__esModule) {
        return obj;
      }
      if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return { default: obj };
      }
      var cache = _getRequireWildcardCache(nodeInterop);
      if (cache && cache.has(obj)) {
        return cache.get(obj);
      }
      var newObj = {};
      var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
      for (var key in obj) {
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
          var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
          if (desc && (desc.get || desc.set)) {
            Object.defineProperty(newObj, key, desc);
          } else {
            newObj[key] = obj[key];
          }
        }
      }
      newObj.default = obj;
      if (cache) {
        cache.set(obj, newObj);
      }
      return newObj;
    }
    function _defineProperties(target, props) {
      for (var i = 0; i < props.length; i++) {
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor)
          descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
      }
    }
    function _createClass(Constructor, protoProps, staticProps) {
      if (protoProps)
        _defineProperties(Constructor.prototype, protoProps);
      if (staticProps)
        _defineProperties(Constructor, staticProps);
      return Constructor;
    }
    var MiniAppHistory = function() {
      function MiniAppHistory2(routes) {
        this.location = new _Location.default();
        (0, _router.__updateRouterMap)(routes);
        Object.assign(this, (0, _router.default)(this.location));
      }
      var _proto = MiniAppHistory2.prototype;
      _proto.listen = function listen(callback) {
        var listeners = (0, _listeners.addListener)(this.location._pageId, callback);
        return function() {
          var index = -1;
          for (var idx in listeners) {
            if (listeners[idx] === callback) {
              index = idx;
              break;
            }
          }
          if (index > -1)
            listeners.splice(index, 1);
        };
      };
      _createClass(MiniAppHistory2, [{
        key: "length",
        get: function get() {
          return getCurrentPages().length;
        }
      }]);
      return MiniAppHistory2;
    }();
    exports.default = MiniAppHistory;
  }
});

// node_modules/miniapp-history/es/index.js
var require_es = __commonJS({
  "node_modules/miniapp-history/es/index.js"(exports) {
    "use strict";
    exports.__esModule = true;
    exports.createMiniAppHistory = createMiniAppHistory2;
    var _History = _interopRequireDefault(require_History());
    function _interopRequireDefault(obj) {
      return obj && obj.__esModule ? obj : { default: obj };
    }
    var history2;
    function createMiniAppHistory2(routes) {
      if (history2)
        return history2;
      return history2 = new _History.default(routes);
    }
  }
});

// node_modules/create-app-shared/lib/env.js
var env_exports = {};
__export(env_exports, {
  isMiniAppPlatform: () => isMiniAppPlatform
});
var import_universal_env = __toModule(require_lib());
__reExport(env_exports, __toModule(require_lib()));
var isMiniAppPlatform = (import_universal_env.isMiniApp || import_universal_env.isWeChatMiniProgram || import_universal_env.isByteDanceMicroApp || import_universal_env.isBaiduSmartProgram || import_universal_env.isKuaiShouMiniProgram) && !import_universal_env.isWeb;

// node_modules/create-app-shared/lib/miniapp/enhanceWithRouter.js
function enhanceWithRouter(_a2) {
  var createElement = _a2.createElement;
  var withRouter2 = function(Component) {
    function Wrapper(props) {
      var history2 = window.history;
      return createElement(Component, Object.assign({}, props, {
        history: history2,
        location: history2.location
      }));
    }
    Wrapper.displayName = "withRouter(" + (Component.displayName || Component.name) + ")";
    Wrapper.WrappedComponent = Component;
    return Wrapper;
  };
  return withRouter2;
}
var enhanceWithRouter_default = enhanceWithRouter;

// node_modules/create-app-shared/lib/constants.js
var _a;
var SHOW = "show";
var HIDE = "hide";
var LAUNCH = "launch";
var ERROR = "error";
var NOT_FOUND = "notfound";
var SHARE = "share";
var TAB_ITEM_CLICK = "tabitemclick";
var MINIAPP_PAGE_LIFECYCLE = (_a = {}, _a[SHOW] = "miniapp_pageshow", _a[HIDE] = "miniapp_pagehide", _a);
var DEFAULT_APP_CONFIG = {
  app: {
    rootId: "root"
  },
  router: {
    type: "hash"
  }
};

// node_modules/create-app-shared/lib/utils/type.js
var isFunction = function(target) {
  return typeof target === "function";
};

// node_modules/create-app-shared/lib/utils/pathRedirect.js
var import_universal_env2 = __toModule(require_lib());
var TARGET_PATH_REG = /[?&]_path=([^&#]+)/i;
function pathRedirect(history2, routes) {
  var targetPath = "";
  var targetQuery = null;
  if (import_universal_env2.isWeb && TARGET_PATH_REG.test(window.location.search)) {
    targetQuery = window.location.search.match(TARGET_PATH_REG);
  }
  if (import_universal_env2.isWeex && TARGET_PATH_REG.test(window.location.href)) {
    targetQuery = window.location.href.match(TARGET_PATH_REG);
  }
  if (!targetQuery && TARGET_PATH_REG.test(history2.location.search)) {
    targetQuery = history2.location.search.match(TARGET_PATH_REG);
  }
  var isConfirmed = false;
  targetPath = targetQuery ? targetQuery[1] : "";
  for (var i = 0, l = routes.length; i < l; i++) {
    if (targetPath === routes[i].path) {
      isConfirmed = true;
      break;
    }
  }
  if (targetPath && !isConfirmed) {
    console.warn("Warning: url query `_path` should be an exist path in app.json, see: https://rax.js.org/docs/guide/routes ");
    return false;
  }
  if (targetPath) {
    history2.replace(targetPath + history2.location.search);
  }
}

// node_modules/create-app-shared/lib/appLifeCycles.js
var appCycles = {};
function emit(cycle, context) {
  var args = [];
  for (var _i = 2; _i < arguments.length; _i++) {
    args[_i - 2] = arguments[_i];
  }
  if (Object.prototype.hasOwnProperty.call(appCycles, cycle)) {
    var cycles = appCycles[cycle];
    if (cycle === SHARE) {
      args[0].content = context ? cycles[0].call(context, args[1]) : cycles[0](args[1]);
    } else {
      cycles.forEach(function(fn) {
        context ? fn.apply(context, args) : fn.apply(void 0, args);
      });
    }
  }
}
function addAppLifeCycle(cycle, callback) {
  if (isFunction(callback)) {
    appCycles[cycle] = appCycles[cycle] || [];
    appCycles[cycle].push(callback);
  }
}

// node_modules/create-app-shared/lib/router.js
var current = {
  pathname: "/",
  visibilityState: true
};
var router = {
  prev: null,
  current
};
Object.defineProperty(router, "current", {
  get: function() {
    return current;
  },
  set: function(value) {
    Object.assign(current, value);
  }
});
var router_default = router;

// node_modules/create-app-shared/lib/pageLifeCycles.js
var __extends = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p))
          d2[p] = b2[p];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var visibleListeners = {};
function addPageLifeCycle(cycle, callback) {
  var _a2;
  var pathname = router_default.current.pathname;
  if (!visibleListeners[pathname]) {
    visibleListeners[pathname] = (_a2 = {}, _a2[SHOW] = [], _a2[HIDE] = [], _a2);
  }
  visibleListeners[pathname][cycle].push(callback);
}
function emit2(cycle, pathname) {
  var _a2;
  var args = [];
  for (var _i = 2; _i < arguments.length; _i++) {
    args[_i - 2] = arguments[_i];
  }
  if (visibleListeners[pathname] && visibleListeners[pathname][cycle]) {
    for (var i = 0, l = visibleListeners[pathname][cycle].length; i < l; i++) {
      (_a2 = visibleListeners[pathname][cycle])[i].apply(_a2, args);
    }
  }
}
function createPageLifeCycle(useEffect) {
  return function(cycle, callback) {
    useEffect(function() {
      if (cycle === SHOW) {
        callback();
      }
      var pathname = router_default.current.pathname;
      addPageLifeCycle(cycle, callback);
      return function() {
        if (visibleListeners[pathname]) {
          var index = visibleListeners[pathname][cycle].indexOf(callback);
          if (index > -1) {
            visibleListeners[pathname][cycle].splice(index, 1);
          }
        }
      };
    }, []);
  };
}
function withPageLifeCycle(Component) {
  var Wrapper = function(_super) {
    __extends(Wrapper2, _super);
    function Wrapper2(props, context) {
      var _this = _super.call(this, props, context) || this;
      if (_this.onShow) {
        _this.onShow();
        addPageLifeCycle(SHOW, _this.onShow.bind(_this));
      }
      if (_this.onHide) {
        addPageLifeCycle(HIDE, _this.onHide.bind(_this));
      }
      _this.pathname = router_default.current.pathname;
      return _this;
    }
    Wrapper2.prototype.componentWillUnmount = function() {
      var _a2;
      (_a2 = _super.prototype.componentWillUnmount) === null || _a2 === void 0 ? void 0 : _a2.call(this);
      visibleListeners[this.pathname] = null;
    };
    return Wrapper2;
  }(Component);
  Wrapper.displayName = "withPageLifeCycle(" + (Component.displayName || Component.name) + ")";
  return Wrapper;
}
function createUsePageLifeCycle(_a2) {
  var useEffect = _a2.useEffect;
  var usePageShow = function(callback) {
    createPageLifeCycle(useEffect)(SHOW, callback);
  };
  var usePageHide = function(callback) {
    createPageLifeCycle(useEffect)(HIDE, callback);
  };
  return {
    usePageShow,
    usePageHide
  };
}

// node_modules/create-app-shared/lib/miniapp/pageLifeCycles.js
var __extends2 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p))
          d2[p] = b2[p];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
function addPageLifeCycle2(cycle, callback) {
  document.addEventListener(MINIAPP_PAGE_LIFECYCLE[cycle], callback);
}
function createPageLifeCycle2(useEffect) {
  return function(cycle, callback) {
    useEffect(function() {
      if (cycle === SHOW) {
        callback();
      }
      addPageLifeCycle2(cycle, callback);
      return function() {
        document.removeEventListener(MINIAPP_PAGE_LIFECYCLE[cycle], callback);
      };
    }, []);
  };
}
function withPageLifeCycle2(Component) {
  var Wrapper = function(_super) {
    __extends2(Wrapper2, _super);
    function Wrapper2(props, context) {
      var _this = _super.call(this, props, context) || this;
      if (_this.onShow) {
        addPageLifeCycle2(SHOW, _this.onShow.bind(_this));
      }
      if (_this.onHide) {
        addPageLifeCycle2(HIDE, _this.onHide.bind(_this));
      }
      return _this;
    }
    Wrapper2.prototype.componentWillUnmount = function() {
      var _a2;
      (_a2 = _super.prototype.componentWillUnmount) === null || _a2 === void 0 ? void 0 : _a2.call(this);
    };
    return Wrapper2;
  }(Component);
  Wrapper.displayName = "withPageLifeCycle(" + (Component.displayName || Component.name) + ")";
  return Wrapper;
}
function createUsePageLifeCycle2(_a2) {
  var useEffect = _a2.useEffect;
  var usePageShow = function(callback) {
    createPageLifeCycle2(useEffect)(SHOW, callback);
  };
  var usePageHide = function(callback) {
    createPageLifeCycle2(useEffect)(HIDE, callback);
  };
  return {
    usePageShow,
    usePageHide
  };
}

// node_modules/create-app-shared/lib/miniapp/history.js
var import_miniapp_history = __toModule(require_es());

// node_modules/create-app-shared/lib/createInitHistory.js
var createInitHistory_default = function(createHistory5) {
  return function(appConfig, options) {
    if (options === void 0) {
      options = { staticConfig: { routes: [] } };
    }
    if (!appConfig.router) {
      appConfig.router = DEFAULT_APP_CONFIG.router;
    }
    var _a2 = options.initialContext, initialContext = _a2 === void 0 ? null : _a2, _b = options.staticConfig, staticConfig = _b === void 0 ? { routes: [] } : _b;
    var router3 = appConfig.router;
    var _c = router3.type, type = _c === void 0 ? DEFAULT_APP_CONFIG.router.type : _c, basename = router3.basename, customHistory = router3.history;
    var location = initialContext ? initialContext.location : null;
    var newHistory = createHistory5({ type, basename, location, customHistory, routes: staticConfig.routes });
    appConfig.router.history = newHistory;
  };
};

// node_modules/create-app-shared/lib/storage.js
var history = null;
var storage = {
  history: null
};
function getHistory() {
  return storage.history;
}
function setHistory(customHistory) {
  history = customHistory;
  storage.history = customHistory;
}

// node_modules/create-app-shared/lib/miniapp/history.js
var createHistory = function(_a2) {
  var routes = _a2.routes;
  if (process.env.__IS_SERVER__) {
    return null;
  }
  window.history = (0, import_miniapp_history.createMiniAppHistory)(routes);
  window.location = window.history.location;
  setHistory(window.history);
  return window.history;
};
var initHistory = createInitHistory_default(createHistory);
var history_default = createHistory;

// node_modules/create-app-shared/lib/web/history.js
var createHistory2 = function(_a2) {
  var type = _a2.type, basename = _a2.basename, location = _a2.location;
  var history2;
  if (process.env.__IS_SERVER__) {
    history2 = createMemoryHistory();
    history2.location = location;
  }
  if (type === "hash") {
    history2 = createHashHistory({ basename });
  } else if (type === "browser") {
    history2 = createBrowserHistory({ basename });
  } else {
    history2 = createMemoryHistory();
  }
  setHistory(history2);
  return history2;
};
var initHistory2 = createInitHistory_default(createHistory2);
var history_default2 = createHistory2;

// node_modules/create-app-shared/lib/weex/history.js
var createHistory3 = function() {
  var history2 = createMemoryHistory();
  setHistory(history2);
  return history2;
};
var initHistory3 = createInitHistory_default(createHistory3);
var history_default3 = createHistory3;

// node_modules/create-app-shared/lib/emitLifeCycles.js
var __assign = function() {
  __assign = Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s)
        if (Object.prototype.hasOwnProperty.call(s, p))
          t[p] = s[p];
    }
    return t;
  };
  return __assign.apply(this, arguments);
};
function emitLifeCycles() {
  var history2 = getHistory();
  var pathname = history2 && history2.location ? history2.location.pathname : typeof window !== "undefined" && window.location.pathname;
  router_default.current = {
    pathname,
    visibilityState: true
  };
  emit(LAUNCH);
  emit(SHOW);
  if (history2 && history2.listen) {
    history2.listen(function(location) {
      if (location.pathname !== router_default.current.pathname) {
        router_default.prev = __assign({}, router_default.current);
        router_default.current = {
          pathname: location.pathname,
          visibilityState: true
        };
        router_default.prev.visibiltyState = false;
        emit2(HIDE, router_default.prev.pathname);
        emit2(SHOW, router_default.current.pathname);
      }
    });
  }
}
var emitLifeCycles_default = emitLifeCycles;

// node_modules/create-app-shared/lib/miniapp/router.js
var current2 = {
  pathname: "/",
  visibilityState: true
};
var router2 = {
  prev: null,
  current: current2
};
Object.defineProperty(router2, "current", {
  get: function() {
    return current2;
  },
  set: function(value) {
    Object.assign(current2, value);
  }
});
var router_default2 = router2;

// node_modules/create-app-shared/lib/miniapp/emitLifeCycles.js
function emitLifeCycles2() {
  router_default2.current = {
    pathname: window.__pageId,
    visibilityState: true
  };
}
var emitLifeCycles_default2 = emitLifeCycles2;

// node_modules/create-app-shared/lib/getSearchParams.js
var queryString = __toModule(require_query_string());
function getSearchParams_default(history2) {
  if (history2 === void 0) {
    history2 = getHistory();
  }
  if (!history2 && typeof window !== "undefined" && window.history) {
    history2 = window.history;
  }
  if (history2 && history2.location && history2.location.search) {
    return queryString.parse(history2.location.search);
  }
  return {};
}

// node_modules/create-app-shared/lib/collectAppLifeCycle.js
function collectAppLifeCycle(appConfig) {
  var _a2 = appConfig.app, onLaunch = _a2.onLaunch, onShow = _a2.onShow, onError = _a2.onError, onHide = _a2.onHide, onTabItemClick = _a2.onTabItemClick;
  addAppLifeCycle(LAUNCH, onLaunch);
  addAppLifeCycle(SHOW, onShow);
  addAppLifeCycle(ERROR, onError);
  addAppLifeCycle(HIDE, onHide);
  addAppLifeCycle(TAB_ITEM_CLICK, onTabItemClick);
}

// node_modules/create-app-shared/lib/miniapp/initAppLifeCycles.js
function initAppLifeCycles() {
  window.addEventListener(LAUNCH, function(_a2) {
    var options = _a2.options, context = _a2.context;
    emit(LAUNCH, context, options);
  });
  window.addEventListener("appshow", function(_a2) {
    var options = _a2.options, context = _a2.context;
    emit(SHOW, context, options);
  });
  window.addEventListener("apphide", function(_a2) {
    var context = _a2.context;
    emit(HIDE, context);
  });
  window.addEventListener("apperror", function(_a2) {
    var context = _a2.context, error = _a2.error;
    emit(ERROR, context, error);
  });
  window.addEventListener("pagenotfound", function(_a2) {
    var context = _a2.context;
    emit(NOT_FOUND, context);
  });
  window.addEventListener("appshare", function(_a2) {
    var context = _a2.context, shareInfo = _a2.shareInfo, options = _a2.options;
    emit(SHARE, context, shareInfo, options);
  });
  window.addEventListener("tabitemclick", function(_a2) {
    var options = _a2.options, context = _a2.context;
    emit(TAB_ITEM_CLICK, context, options);
  });
}
var initAppLifeCycles_default = initAppLifeCycles;

// node_modules/create-app-shared/lib/weex/initAppLifeCycles.js
function initAppLifeCycles2() {
  try {
    var globalEvent = __weex_require__("@weex-module/globalEvent");
    globalEvent.addEventListener("WXApplicationDidBecomeActiveEvent", function() {
      router_default.current.visibilityState = true;
      emit(SHOW);
      emit2(SHOW, router_default.current.pathname);
    });
    globalEvent.addEventListener("WXApplicationWillResignActiveEvent", function() {
      router_default.current.visibilityState = false;
      emit2(HIDE, router_default.current.pathname);
      emit(HIDE);
    });
  } catch (err) {
    console.log("@weex-module/globalEvent error: " + err);
  }
}
var initAppLifeCycles_default2 = initAppLifeCycles2;

// node_modules/create-app-shared/lib/web/initAppLifeCycles.js
function initAppLifeCycles3() {
  if (typeof document !== "undefined" && typeof window !== "undefined") {
    document.addEventListener("visibilitychange", function() {
      var history2 = getHistory();
      var currentPathName = history2 ? history2.location.pathname : router_default.current.pathname;
      if (currentPathName === router_default.current.pathname) {
        router_default.current.visibilityState = !router_default.current.visibilityState;
        if (router_default.current.visibilityState) {
          emit(SHOW);
          emit2(SHOW, router_default.current.pathname);
        } else {
          emit2(HIDE, router_default.current.pathname);
          emit(HIDE);
        }
      }
    });
    window.addEventListener("error", function(event) {
      emit(ERROR, null, event.error);
    });
  }
}
var initAppLifeCycles_default3 = initAppLifeCycles3;

// node_modules/create-app-shared/lib/runtimeModule.js
var __assign2 = function() {
  __assign2 = Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s)
        if (Object.prototype.hasOwnProperty.call(s, p))
          t[p] = s[p];
    }
    return t;
  };
  return __assign2.apply(this, arguments);
};
var __rest = function(s, e) {
  var t = {};
  for (var p in s)
    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
      t[p] = s[p];
  if (s != null && typeof Object.getOwnPropertySymbols === "function")
    for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
        t[p[i]] = s[p[i]];
    }
  return t;
};
var RuntimeModule = function() {
  function RuntimeModule2(appConfig, buildConfig, context, staticConfig) {
    var _this = this;
    this.registerRuntimeAPI = function(key, api) {
      if (_this.apiRegistration[key]) {
        console.warn("api " + key + " had already been registered");
      } else {
        _this.apiRegistration[key] = api;
      }
    };
    this.applyRuntimeAPI = function(key) {
      var _a2;
      var args = [];
      for (var _i = 1; _i < arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
      }
      if (!_this.apiRegistration[key]) {
        console.warn("unknown api " + key);
      } else {
        return (_a2 = _this.apiRegistration)[key].apply(_a2, args);
      }
    };
    this.setRuntimeValue = function(key, value) {
      if (Object.prototype.hasOwnProperty.call(_this.internalValue, key)) {
        console.warn("internal value " + key + " had already been registered");
      } else {
        _this.internalValue[key] = value;
      }
    };
    this.getRuntimeValue = function(key) {
      return _this.internalValue[key];
    };
    this.setRenderApp = function(renderRouter) {
      _this.renderApp = renderRouter;
    };
    this.wrapperRouterRender = function(wrapper) {
      _this.renderApp = wrapper(_this.renderApp);
    };
    this.addProvider = function(Provider) {
      _this.AppProvider.push(Provider);
    };
    this.addDOMRender = function(render) {
      _this.modifyDOMRender = render;
    };
    this.modifyRoutes = function(modifyFn) {
      _this.modifyRoutesRegistration.push(modifyFn);
    };
    this.modifyRoutesComponent = function(modify) {
      _this.routesComponent = modify(_this.routesComponent);
    };
    this.wrapperPageComponent = function(wrapperPage) {
      _this.wrapperPageRegistration.push(wrapperPage);
    };
    this.wrapperRoutes = function(routes) {
      return routes.map(function(item) {
        if (item.children) {
          item.children = _this.wrapperRoutes(item.children);
        } else if (item.component) {
          item.routeWrappers = _this.wrapperPageRegistration;
        }
        return item;
      });
    };
    this.getWrapperPageRegistration = function() {
      return _this.wrapperPageRegistration;
    };
    this.getAppComponent = function() {
      if (_this.modifyRoutesRegistration.length > 0) {
        var routes = _this.wrapperRoutes(_this.modifyRoutesRegistration.reduce(function(acc, curr) {
          return curr(acc);
        }, []));
        return _this.renderApp(routes, _this.routesComponent);
      }
      return _this.renderApp(_this.wrapperPageRegistration.reduce(function(acc, curr) {
        return curr(acc);
      }, _this.appConfig.renderComponent));
    };
    this.AppProvider = [];
    this.appConfig = appConfig;
    this.buildConfig = buildConfig;
    this.context = context;
    this.staticConfig = staticConfig;
    this.modifyDOMRender = null;
    this.apiRegistration = {};
    this.internalValue = {};
    this.renderApp = function(AppComponent) {
      return AppComponent;
    };
    this.routesComponent = false;
    this.modifyRoutesRegistration = [];
    this.wrapperPageRegistration = [];
  }
  RuntimeModule2.prototype.loadModule = function(module) {
    var enabledRouter = !this.appConfig.renderComponent;
    var runtimeAPI = {
      addProvider: this.addProvider,
      addDOMRender: this.addDOMRender,
      applyRuntimeAPI: this.applyRuntimeAPI,
      wrapperPageComponent: this.wrapperPageComponent,
      appConfig: this.appConfig,
      buildConfig: this.buildConfig,
      context: this.context,
      setRenderApp: this.setRenderApp,
      staticConfig: this.staticConfig,
      getRuntimeValue: this.getRuntimeValue
    };
    if (enabledRouter) {
      runtimeAPI = __assign2(__assign2({}, runtimeAPI), { modifyRoutes: this.modifyRoutes, wrapperRouterRender: this.wrapperRouterRender, modifyRoutesComponent: this.modifyRoutesComponent });
    }
    var runtimeModule = module.default || module;
    if (module)
      runtimeModule(runtimeAPI);
  };
  RuntimeModule2.prototype.composeAppProvider = function() {
    var _this = this;
    if (!this.AppProvider.length)
      return null;
    return this.AppProvider.reduce(function(ProviderComponent, CurrentProvider) {
      return function(_a2) {
        var children = _a2.children, rest = __rest(_a2, ["children"]);
        var element = CurrentProvider ? _this.context.createElement(CurrentProvider, __assign2({}, rest), children) : children;
        return _this.context.createElement(ProviderComponent, __assign2({}, rest), element);
      };
    });
  };
  return RuntimeModule2;
}();
var runtimeModule_default = RuntimeModule;

// node_modules/create-app-shared/lib/createBaseApp.js
function mergeDefaultConfig(defaultConfig, config) {
  Object.keys(defaultConfig).forEach(function(key) {
    if (typeof config[key] === "object" && config[key] !== null) {
      config[key] = mergeDefaultConfig(defaultConfig[key], config[key]);
    } else if (!Object.prototype.hasOwnProperty.call(config, key)) {
      config[key] = defaultConfig[key];
    }
  });
  return config;
}
var createBaseApp_default = function(_a2) {
  var loadRuntimeModules = _a2.loadRuntimeModules, createElement = _a2.createElement, _b = _a2.runtimeAPI, runtimeAPI = _b === void 0 ? {} : _b, _c = _a2.runtimeValue, runtimeValue = _c === void 0 ? {} : _c;
  var createBaseApp = function(appConfig, buildConfig, context, staticConfig) {
    appConfig = mergeDefaultConfig(DEFAULT_APP_CONFIG, appConfig);
    context.createElement = createElement;
    var runtime = new runtimeModule_default(appConfig, buildConfig, context, staticConfig);
    Object.keys(runtimeAPI).forEach(function(apiKey) {
      runtime.registerRuntimeAPI(apiKey, runtimeAPI[apiKey]);
    });
    Object.keys(runtimeValue).forEach(function(key) {
      runtime.setRuntimeValue(key, runtimeValue[key]);
    });
    loadRuntimeModules(runtime);
    collectAppLifeCycle(appConfig);
    return {
      runtime,
      appConfig
    };
  };
  return createBaseApp;
};

// node_modules/create-app-shared/lib/nativeEventListener.js
function registerNativeEventListeners(Klass, events) {
}
function addNativeEventListener(eventName, callback) {
  document.addEventListener(eventName, callback);
}
function removeNativeEventListener(eventName, callback) {
  document.removeEventListener(eventName, callback);
}

// node_modules/create-app-shared/lib/index.js
var initAppLifeCycles4;
var createHistory4;
var withRouter;
var initHistory4;
var emitLifeCycles3;
var withPageLifeCycle3;
var createUsePageLifeCycle3;
if (isMiniAppPlatform) {
  withRouter = enhanceWithRouter_default;
  createHistory4 = history_default;
  initAppLifeCycles4 = initAppLifeCycles_default;
  initHistory4 = initHistory;
  emitLifeCycles3 = emitLifeCycles_default2;
  withPageLifeCycle3 = withPageLifeCycle2;
  createUsePageLifeCycle3 = createUsePageLifeCycle2;
} else if (env_exports.isWeex || env_exports.isKraken) {
  createHistory4 = history_default3;
  initAppLifeCycles4 = initAppLifeCycles_default2;
  initHistory4 = initHistory3;
  emitLifeCycles3 = emitLifeCycles_default;
  withPageLifeCycle3 = withPageLifeCycle;
  createUsePageLifeCycle3 = createUsePageLifeCycle;
} else {
  createHistory4 = history_default2;
  initAppLifeCycles4 = initAppLifeCycles_default3;
  initHistory4 = initHistory2;
  emitLifeCycles3 = emitLifeCycles_default;
  withPageLifeCycle3 = withPageLifeCycle;
  createUsePageLifeCycle3 = createUsePageLifeCycle;
}
export {
  runtimeModule_default as RuntimeModule,
  addAppLifeCycle,
  addNativeEventListener,
  collectAppLifeCycle,
  createBaseApp_default as createBaseApp,
  createHistory4 as createHistory,
  createUsePageLifeCycle3 as createUsePageLifeCycle,
  emitLifeCycles3 as emitLifeCycles,
  getHistory,
  getSearchParams_default as getSearchParams,
  history,
  initAppLifeCycles4 as initAppLifeCycles,
  initHistory4 as initHistory,
  pathRedirect,
  registerNativeEventListeners,
  removeNativeEventListener,
  setHistory,
  withPageLifeCycle3 as withPageLifeCycle,
  withRouter
};
//# sourceMappingURL=create-app-shared.js.map
